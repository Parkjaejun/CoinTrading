# 🚀 자동매매 시스템 실행 가이드

## 📦 파일 설치

다운로드한 파일들을 프로젝트 폴더에 복사하세요:

```bash
cd D:\Project\CoinTrading

# 1. OrderManager (주문 실행)
copy D:\Downloads\okx_order_manager_final.py okx\order_manager.py

# 2. 자동매매 엔진
copy D:\Downloads\trading_engine.py .

# 3. GUI 위젯
copy D:\Downloads\auto_trading_widget.py gui\
```

---

## 🎮 실행 방법

### 방법 1: CLI로 직접 실행 (간단)

```bash
python trading_engine.py
```

```
🤖 OKX 자동매매 엔진
============================================================

⚠️ 이 프로그램은 실제 자금으로 거래합니다!
자동매매를 시작하시겠습니까? (yes 입력): yes

🚀 자동매매 엔진 초기화 중...
✅ OrderManager 연결 완료
✅ 가격 버퍼 생성: BTC-USDT-SWAP
✅ 롱 전략 생성: BTC-USDT-SWAP (레버리지: 10x)
✅ 숏 전략 생성: BTC-USDT-SWAP (레버리지: 3x)
📊 BTC-USDT-SWAP 과거 데이터 로드 중...
✅ BTC-USDT-SWAP: 200개 캔들 로드 완료
============================================================
✅ 자동매매 엔진 초기화 완료!
📊 거래 심볼: BTC-USDT-SWAP
💰 초기 자본: $1000.00
⏰ 체크 간격: 60초
============================================================

🔄 자동매매 실행 중... (Ctrl+C로 중지)
```

### 방법 2: GUI에서 실행

```bash
python run_gui.py
```

1. **🎯 모니터링** 탭 또는 새로운 **🤖 자동매매** 탭 선택
2. 전략 설정 (레버리지, 트레일링스탑 등)
3. **🚀 자동매매 시작** 버튼 클릭
4. 확인 다이얼로그에서 "Yes" 클릭

---

## ⚙️ 전략 설정

### 롱 전략 (기본값)
| 설정 | 값 | 설명 |
|------|---|------|
| 레버리지 | 10x | 높은 수익/위험 |
| 트레일링스탑 | 10% | 고점 대비 10% 하락 시 청산 |
| 진입 조건 | 20/50 EMA 골든크로스 | 상승 추세에서 진입 |
| 청산 조건 | 20/100 EMA 데드크로스 | 하락 신호 시 청산 |

### 숏 전략 (기본값)
| 설정 | 값 | 설명 |
|------|---|------|
| 레버리지 | 3x | 보수적 |
| 트레일링스탑 | 2% | 저점 대비 2% 상승 시 청산 |
| 진입 조건 | 20/50 EMA 데드크로스 | 하락 추세에서 진입 |
| 청산 조건 | 100/200 EMA 골든크로스 | 상승 신호 시 청산 |

---

## 📊 작동 원리

```
┌─────────────────────────────────────────────────────────────┐
│                    자동매매 엔진 루프                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 가격 데이터 수집 (30분봉)                                │
│         ↓                                                   │
│  2. EMA 계산 (20, 50, 100, 150, 200)                        │
│         ↓                                                   │
│  3. 트렌드 확인                                              │
│     - 롱: 150 EMA > 200 EMA (상승장)                        │
│     - 숏: 150 EMA < 200 EMA (하락장)                        │
│         ↓                                                   │
│  4. 진입 신호 확인                                           │
│     - 롱: 20/50 EMA 골든크로스                               │
│     - 숏: 20/50 EMA 데드크로스                               │
│         ↓                                                   │
│  5. 청산 신호 확인                                           │
│     - 트레일링스탑                                           │
│     - EMA 크로스                                             │
│         ↓                                                   │
│  6. 주문 실행 (OrderManager)                                 │
│         ↓                                                   │
│  7. 60초 대기 후 1번으로                                     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 🛡️ 안전 장치

### 1. 가상/실제 모드 자동 전환

| 조건 | 동작 |
|------|------|
| 고점 대비 20% 손실 | 실제 → 가상 모드 전환 |
| 저점 대비 30% 회복 | 가상 → 실제 모드 복귀 |

### 2. 트레일링스탑
- 롱: 고점 대비 10% 하락 시 자동 청산
- 숏: 저점 대비 2% 상승 시 자동 청산

### 3. 포지션 크기 제한
- 기본: 자본의 10%만 사용
- 최대 $100 제한

---

## 📈 모니터링

엔진 실행 중 5분마다 상태 출력:

```
======================================================================
📊 자동매매 엔진 상태 - 2026-01-13 19:30:00
======================================================================
⏱️ 실행 시간: 1:30:00
📈 총 신호: 5개
💰 실행 거래: 2개

📋 전략 상태:
  [long_BTC-USDT-SWAP] 🟢실제 📈보유
      자본: $1050.00 | 승률: 66.7% | 총손익: $50.00
  [short_BTC-USDT-SWAP] 🟡가상 ⏳대기
      자본: $980.00 | 승률: 50.0% | 총손익: -$20.00

💼 현재 포지션:
  BTC-USDT-SWAP net: 0.01 @ $92,000.00
      손익: $15.00 (1.63%)
======================================================================
```

---

## ⚠️ 주의사항

1. **실제 자금 사용** - 테스트 시 소액으로 시작
2. **24시간 실행 필요** - 컴퓨터가 켜져 있어야 함
3. **네트워크 안정성** - 인터넷 연결 필수
4. **시장 모니터링** - 급변동 시 수동 개입 필요

---

## 🔧 문제 해결

### 엔진이 시작되지 않을 때
```bash
# OrderManager 테스트
python test_order_manager.py
```

### 주문이 실패할 때
- OKX 계좌 모드 확인 (Single-currency margin)
- API 권한 확인 (거래 권한)
- 잔고 확인

### 신호가 발생하지 않을 때
- 데이터 로드 확인 (200개 캔들 필요)
- 현재 시장 상황 확인 (트렌드 조건)

---

## 🛑 중지 방법

### CLI
```
Ctrl + C
```

### GUI
**🛑 중지** 버튼 클릭

---

*마지막 업데이트: 2026-01-13*
